<ion-content fullscreen="true">
  <ion-grid>
    <ion-row>
      <ion-col size="12" offset="0" size-md="12" offset-md="0" size-md="10" offset-md="1" size-xl="8" offset-xl="2">
        <ion-header class="no-shadow">
          <ion-toolbar>
            <ion-buttons slot="start">
              <ion-menu-button></ion-menu-button>
              <ion-back-button [defaultHref]="'/app/wallet/' + previousAddress"></ion-back-button>
            </ion-buttons>
            <ion-title>
              Manage Token <span *ngIf="!isLoading">#{{ token.id }}</span>
            </ion-title>
          </ion-toolbar>
        </ion-header>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="12" offset="0" size-md="12" offset-md="0" size-md="10" offset-md="1" size-xl="8" offset-xl="2"
        class="main-content">
        <div class="p-4">
          <div class="loading" *ngIf="isLoading">
            <ion-progress-bar type="indeterminate"></ion-progress-bar>
            <p>
              Loading token...
            </p>
          </div>
        </div>
        <div class="aligned" *ngIf="!isLoading">
          <ion-grid>
            <ion-row>
              <ion-col size-lg="2" size-xs="4">
                <div class="text-center">
                  <img class="rounded" [src]="token.content_path" *ngIf="token.content_path" />
                  <div class="ticker" *ngIf="!token.content_path">
                    <img class="no-logo rounded" src="../../assets/logo/a-white-on-transparent-250.png" />
                  </div>
                </div>
              </ion-col>
              <ion-col size-xl="8" size-lg="6" size-sm="8" size-xs="8">
                <h1 class="mt-0">{{ token.ticker }}</h1>
                <p class="note">{{ token.name }}</p>
              </ion-col>
            </ion-row>
            <ion-row class="own-balance mt-3" *ngIf="walletConnected">
              <ion-col size="12" class="ps-3 pt-0">
                <h4>Your balance</h4>
                <div class="meta">
                  <span class="label"></span>
                  <span class="value">{{ holding.amount | tokenDecimals:token.decimals }}
                    {{ token.ticker }} ($0.0)</span>
                </div>
                <div class="mt-2 mb-3">
                  <ion-button color="primary" fill="clear" (click)="transfer()"
                    [disabled]="holding.amount == 0">Send</ion-button>
                  <ion-button color="primary" fill="clear" (click)="listSale()"
                    [disabled]="holding.amount == 0">Sell</ion-button>
                  <ion-button color="primary" fill="clear"
                    [routerLink]="['/app/market', token.ticker]">Trade</ion-button>
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
          <ion-grid class="history">
            <ion-row>
              <ion-col size="6" class="header">
                Transaction History
              </ion-col>
            </ion-row>
            <ion-row class="break">
              <ion-col size="12">
                <p-table #data [value]="history" [tableStyle]="{ 'min-width': '40rem' }" [paginator]="true" [rows]="10"
                  [showCurrentPageReport]="true"
                  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} records"
                  styleClass="token-list" sortField="date_created" [sortOrder]="-1">
                  <ng-template pTemplate="header">
                    <tr>
                      <th pSortableColumn="date_created">Date <p-sortIcon field="date_created"></p-sortIcon></th>
                      <th pSortableColumn="height" pFrozenColumn>Block <p-sortIcon field="height"></p-sortIcon>
                      </th>
                      <th pSortableColumn="action">Action <p-sortIcon field="action"></p-sortIcon></th>
                      <th pSortableColumn="amount">Amount <p-sortIcon field="amount"></p-sortIcon></th>
                      <th pSortableColumn="sender">Sender <p-sortIcon field="sender"></p-sortIcon></th>
                      <th pSortableColumn="receiver">Receiver <p-sortIcon field="receiver"></p-sortIcon></th>
                      <th>&nbsp;</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-item>
                    <tr>
                      <td>
                        {{ item.date_created | date }}
                      </td>
                      <td>
                        {{ item.height | number }}
                      </td>
                      <td>
                        {{ item.action }}
                      </td>
                      <td>
                        {{ item.amount | tokenDecimals:item.token.decimals | number:"1.1-6" }}
                      </td>
                      <td>
                        {{ item.sender | shortenAddress }}
                      </td>
                      <td>
                        {{ item.receiver | shortenAddress }}
                      </td>
                      <td>
                        <a href="{{explorerTxUrl}}{{item.transaction.hash}}" target="_blank">View on Mintscan</a>
                      </td>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="emptymessage">
                    <tr>
                      <td colspan="4">No history yet</td>
                    </tr>
                  </ng-template>
                </p-table>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
        <div style="height: 100px;"></div>
      </ion-col>
    </ion-row>
  </ion-grid>

</ion-content>